Category: Reverse engineering 

Points: 300

Author: Prince Niyonshuti N.
### Description
Get ready for a mischievous adventure with your favorite Minions! üïµÔ∏è‚Äç‚ôÇÔ∏èüí• They‚Äôve been up to their old tricks, and this time, they've hidden the flag in a devious way within the Android source code. Your task is to channel your inner Minion and dive into the disassembled or decompiled code. Watch out, because these little troublemakers have hidden the flag in multiple sneaky spots or maybe even pulled a fast one and concealed it in the same location! Put on your overalls, grab your magnifying glass, and get cracking. The Minions have left clues, and it's up to you to follow their trail and uncover the flag. Can you outwit these playful pranksters and find their secret? Let the Minion mischief begin! Find the android apk here [Minions Mobile Application](https://challenge-files.picoctf.net/c_saffron_estate/952de3d4a637dda4d8f2d6f6630ce8c0e4dbcf83d65914382d8cb08a546d2a3d/minions.apk) and try to get the flag.

---
### Hints
1: Do you know how to disassemble an apk file?

2: Any interesting source files?

---
### Solution
My first `apk hacking`. We download the APK file and run it with [Android Studio](https://developer.android.com/studio).
To learn how to install and root the emulator we can follow the video of the Youtuber [UnderSecured](https://youtu.be/QzsNn3GhYYk?si=lLbQxnRHPemhOsnx).

After installing the application:

![](attachments/Pasted%20image%2020251002120015.png)

After running the application:

![](attachments/Pasted%20image%2020251002120137.png)

So we need to find the value of a variable named `banana` in the code. To do this, we can use `jadx` or `apktool` to disassemble the apk and search for the `banana` variable with `grep`. The difference between `jadx` and `apktool`:

- **`jadx`** ‚Üí decompiles into **readable Java** (ideal for reading logic quickly).
    
- **`apktool`** ‚Üí decompiles to **smali + resources** (ideal for patching/rebuilding, and for seeing low-level details).


We will use `jadx`. 

![](attachments/Pasted%20image%2020251002121223.png)

Syntax: `jadx -d $HOME/extracted $HOME/minions.apk`

The last step is to search for the `banana` variable in the source code of the APK file with `grep`.

![](attachments/Pasted%20image%2020251002121813.png)

According to [dcode](https://www.dcode.fr), the value of `Banana` is encoded in `base32`

![](attachments/Pasted%20image%2020251002122011.png)

Let's decode: 

![](attachments/Pasted%20image%2020251002122155.png)

GG!