Category: Reverse engineering 

Points: 300

Author: Prince Niyonshuti N.
### Description
Get ready for a mischievous adventure with your favorite Minions! üïµÔ∏è‚Äç‚ôÇÔ∏èüí• They‚Äôve been up to their old tricks, and this time, they've hidden the flag in a devious way within the Android source code. Your task is to channel your inner Minion and dive into the disassembled or decompiled code. Watch out, because these little troublemakers have hidden the flag in multiple sneaky spots or maybe even pulled a fast one and concealed it in the same location! Put on your overalls, grab your magnifying glass, and get cracking. The Minions have left clues, and it's up to you to follow their trail and uncover the flag. Can you outwit these playful pranksters and find their secret? Let the Minion mischief begin! Find the android apk here [Minions Mobile Application](https://challenge-files.picoctf.net/c_saffron_estate/952de3d4a637dda4d8f2d6f6630ce8c0e4dbcf83d65914382d8cb08a546d2a3d/minions.apk) and try to get the flag.

---
### Hints
1: Do you know how to disassemble an apk file?

2: Any interesting source files?

---
### Solution
Mon premier `apk hacking`. Nous t√©l√©chargeons le fichier apk et l'ex√©cutons avec [Android Studio](https://developer.android.com/studio).
Pour apprendre √† installer et rooter l'√©mulateur, nous pouvons suivre la vid√©o du Youtuber [UnderSecured](https://youtu.be/QzsNn3GhYYk?si=lLbQxnRHPemhOsnx).

Apr√®s avoir install√© l'application :

![](attachments/Pasted%20image%2020251002120015.png)

Apr√®s avoir ex√©cuter l'application: 

![](attachments/Pasted%20image%2020251002120137.png)

Nous devons donc rechercher la valeur d'une variable nomm√©e `banana` dans le code. Pour ce faire, nous pouvons utiliser `jadx` ou `apktool` pour d√©sassembler l'apk et rechercher la variable `banana` avec grep. La diff√©rence entre `jadx` et `apktool` :

- **`jadx`** ‚Üí d√©compile en **Java lisible** (id√©al pour lire la logique rapidement).
    
- **`apktool`** ‚Üí d√©compile en **smali + ressources** (id√©al pour patcher/reconstruire, et pour voir des d√©tails bas-niveau).


Nous utiliserons `jadx`. 

![](attachments/Pasted%20image%2020251002121223.png)

Syntaxe: `jadx -d $HOME/extracted $HOME/minions.apk`

- `-d $HOME/extracted`  
    `-d` = _directory_ de sortie. Ici on dit ¬´ √©cris la sortie dans `~/extracted` ¬ª. `$HOME` est la variable d‚Äôenvironnement qui pointe vers notre dossier personnel (ex : `/home/kali).
    
- `$HOME/minions.apk`  
    Le chemin vers l‚ÄôAPK √† analyser (ici `~/minions.apk`). Jadx lit ce fichier en entr√©e.

La derni√®re √©tape est de rechercher la variable `banana` dans le code source du fichier APK avec `grep`.

![](attachments/Pasted%20image%2020251002121813.png)

D'apr√®s [dcode](https://www.dcode.fr), la valeur de `Banana` est encod√©e en `base32`

![](attachments/Pasted%20image%2020251002122011.png)

D√©codons: 

![](attachments/Pasted%20image%2020251002122155.png)

GG!